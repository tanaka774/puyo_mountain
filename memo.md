## TODO
- [ ] make smooth animation
  - [x] can move down per a few pixel
  - [ ] can move left/right per one cell but animation is smooth 
- [ ] handle arrow key input well
- [x] rotate properly
  - need to make it animate while rotating(in teto case, not animating because of applying new piece when rotating)
  - in puyo, animating
- [x] handle mino correctly on top
- [x] ちぎり
- [x] 連鎖判定
- [x] 回した時の押し出し
- [x] 幽霊（13段目）
- [x] remove try-catch after debug
- [x] duration before lockpuyo()
- [x] attach each connecting puyo
- [ ] chain vanish effect
- [ ] bouncing effect after puyo falling (till three puyos below?)
- [ ] remove conditions to check whether puyo doesn't overlap each edge (these should be unnecessary now thanks to wall surrounding with certain number)
- [ ] show chain numbers
- [ ] write test code
- [ ] consider again the calling position of findfloatingpuyo() and not using temp_board
- [ ] remember each puyo steps and implement replay
- [ ] 
### in future
- [ ] migrate to typescript with class-object
- [ ] manage each process with appropriate state
- [ ] store chain info
- [ ] write document
- [ ] detect possible chain
  - if you are able to make specific numbers of chain, detect it and inform user of that (by let puyo glowing?) 
- [ ] save all state including board or currentpuyo
- [ ] consider well ojamapuyo
- [ ] try out svg or jpeg(png) for drawing

## doubtful things
- after lockPuyo() sometimes puyo color turns into 0(invisible)
  - temporalily solved by specifying color directly
- error happens at the line using Math.floor(childY) 
  - handle carefully at top or bottom
  - how to set ghost zone (currently at y:-1)
- sometimes submerge puyo below when angle is 0 or 180
- something wrong with `python -m http.server`
- at y:3, something is wrong with drawing, not setting puyo properly

## memo
- createPattern() for background caching
- only redraw changing objects for performance
- implement well splittedpuyo (currently ugly)
  - prepare specific function for spliting and handle splitting process in some loop like while()?
  - for that you should consider about draw() (requestanimationframe or clear() something)
- check all of board for chain (actually want to check only around locked puyos but kinda hard now)
- what about currentpuyo during chainprocessing?
- separate file per each function (defintely!!)
- be careful for round()!!!!
- you don't need to care diagonally down when rotate
- if you want to record each puyo position, you should use lockpuyo() every lock case(not current implementation separating split and usual falling)
- if you surround board with one cell which is not 0, you would not need to each surroundiing edge check?(can unify collision check?)
### tempmemo
- checkChain() doesn't work right after splitting why
  - this is because handleSplitting() does the same process of lockpuyo() inside 
- checkChain sequencely
- last floatingpuyo vanishes early
- cannot prevent taking input during splitting
- splitting during locking makes weird thing happen
- moving right or left makes puyo submerge adjacent puyo in locking
- draw illustrations of wait-count or somthing later
- lock-wait doesn't work in move right-left and splitting
- sometimes infinite-loop happens with chainprocessing being true and islocked being false
  - what causes this? maybe related to splitting
- should call lockpuyo() in handleSplitting()?
- chain process is still weird
- after splitting nextpuyo becomes weird
- rotating doesn't work correctly, maybe shouldn't move parentpuyo right or left
- sometimes lock-wait doesn't work, maybe when angle is 180
- sometimes key is held down 
- sometimes puyo is locked where is one up on expected cell
- is throttle really suited for input handing??? specifically for rotate
   - need to check how delay time is handled
- in debug, key is left to be held down
- moving smooth horizontally is hard
  - perhaps this isn't need to implement?
- go rotate animation once
- **separate actual puyo pos from actual drawing pos**
- what happens if key input movehor and push by rotate happen at the same time
- you need to remember which puyo is connected to each other when drawing connection
- moving things I want to draw but not to change pos (into float)
  - moving horizontally
  - rotate
  - push up when rotatedangle = 0
- after each chain vanishing or splitting, key input is initialized and you cannnot keep being down key left pressed, have to re-press again each time
- want to update connectedpuyos[] only when new one appears
- drawGlue() doesn't draw any glue!!!
- for debug, implement replay
- sometimes connecting glue doesn't disappear for a little time during floating puyo falling-
- for recording each steps, remember puyos of lockpuyo() and vanishpuyos, and 
- if you did undo once, you never come back to original board state
  - only in gameover, you can undo or redo?
- the reason some of bouncepuyos are left but they aren't on board so they are left forever and stuck in infinite loop when chain happens
  - their places on board are initialized right after lockpuyo() instead of entering draw loop of limited-time
  - how can I fix this?
    - after locking let it entering draw(), and call handlechain() on later frame, for this you should change update() structure about state flow
  - and I want to bounce before chain puyo is erased
  should care about gameover?
- makes bouncing work properly
- want common function to manage time(frame)
- in case ojama puyo exists, modify lowest puyos?
- right after chain process ends, connecting disappears
- during bounce effect connecting disappears temporarily
